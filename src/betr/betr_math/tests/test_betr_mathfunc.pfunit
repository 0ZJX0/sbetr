! -*- mode: f90; -*-
module test_mathfunc_module

  use pfunit_mod

  implicit none

contains

  @test
  subroutine test_heavyside()

    use bshr_kind_mod, only : r8 => shr_kind_r8
    use MathFuncMod, only : heviside
    use LinearAlgebraMod, only : sparse_gemv
    implicit none
    real(r8) :: a(1:4,1:3)
    real(r8) :: b(1:3)
    real(r8) :: ans(1:4)

    @assertEqual(1.0_r8, heviside(0.2_r8))
    @assertEqual(0.0_r8, heviside(-2.0_r8))
    b(:)=(/0._r8,1._r8,0._r8/)
    a(1,:)=(/1._r8,2._r8,3._r8/)
    a(2,:)=(/4._r8,5._r8,6._r8/)
    a(3,:)=(/7._r8,8._r8,9._r8/)
    a(4,:)=(/10._r8,11._r8,12._r8/)
    call sparse_gemv('N', 4, 3, a, 3, b, 4, ans)

    @assertEqual((/2._r8,5._r8,8._r8,11._r8/), ans)
  end subroutine test_heavyside
end module test_mathfunc_module
